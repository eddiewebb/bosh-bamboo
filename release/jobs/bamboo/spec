---
name: bamboo

# these files will be copied to /var/cap/jobs/bamboo/ on the VM after evaluating for expressions
templates:
  bamboo_home/xml-data/configuration/administration.xml: bamboo_home/xml-data/configuration/administration.xml
  bamboo_install/bin/setenv.sh: bamboo_install/bin/setenv.sh
  bamboo_home/bamboo.cfg.xml.xslt: bamboo_home/bamboo.cfg.xml.xslt
  # use bosh managed Lifecycle https://bosh.io/docs/job-lifecycle.html
  job-lifecycle/pre-start.sh: bin/pre-start
  job-lifecycle/bamboo: bin/bamboo # monit start is called, which ivokes `bamboo start` provided by this file.
  #job-lifecycle/post-start.sh: bin/post-start

packages:
- jdk8
- bamboo

consumes:
- name: data-db
  type: database

properties:
  server.ip:
    description: The IP address of the Bamboo server
  server.port:
    description: The port the Bamboo server is running on
    default: 8085
  server.protocol:
    description: Use http or https on master
    default: http
  server.context:
    description: The server context of bamboo (i.e. /builds). It is important to include both  the leading and trailing slash.
    default: /
  bamboo.license:
    description: The License String for this Bamboo Instance
    default: AAAA-notlicensed-ZZZ
